2021/10/13 NT43
【スイッチの冗長化】
冗長化で信頼性を高める
・ユーザーへの影響度の点から、中規模以上の
　ネットワークにおいては、【信頼性】を高める
　ことが最重要課題。
　・小規模ネットワークにおいては、経済性を優先
　　する傾向が強い

・信頼性・安定性を高めるための一つの手段として
　『冗長化』がある。

・端的に言えば『二重化』(=予備を用意)
　スイッチの冗長化とは、通常運用する物の他に、
　予備機も用意しておき運用する。

・スイッチ本体や、ポート、LAN配線に障害が発生
　した場合でも、予備機のスイッチを通じた通信を
　行うことで、継続した運用が可能になる。

・冗長化を実現する技術として、
　『スパニングツリープロトコル』てのがある。

　・冗長経路によるループを検出して、パケットが
　　ループしないように特定のポートをブロックし
　　ツリー上のネットワークを形成。

　・障害検出時には、スパニングツリーを再形成し
　　新たな通信経路を確立。

　・ただし、時代の流れの中で、これは廃れたもの
　　になりつつある。

　・スパニングツリーの問題点
　　　・正常時に、帯域に無駄がある。
　　　・設計・運用が複雑・煩雑

・スパニングツリーに代わる技術の流れ
　・スタック接続
　　　複数台のスイッチを論理的に１台のスイッチ
　　　として扱えるようにする。冗長化されている
　　　スイッチはどちらも稼働状態として運用可能
　
　・リンクアグリゲーション
　　　複数回線(ポート)を束ねて一つのリンクとし
　　　使用する方法。配下のスイッチからは１台の
　　　スイッチとして認識される。

　・現状では、こちらの技術を組み合わせての
　　冗長化が主流
----------
【ルータ】
ネットワーク設計においては、拠点のLANと拠点のLANを結ぶ役割。拠点のLANと外部ネットワークを
接続する役割を担う。

［小規模ネットワークにおいて］
・ルーティング以外の各種機能も担う場合が多い
・コンシュマー向け製品で代用されることも多い
・コスト的に冗長化されないことが多い

［中規模以上のネットワークにおいて］
・ネットワーク間の橋渡し(ルーティング)に徹する
・ルータに求められる仕事の重みは増す

［ルータの原理］
・ネットワーク層(第３層)でネットワークを制御
  →IPアドレスでルーティング処理

［ルーティング(経路指定・経路選択)］
・通信するパケットを適切な経路へ流してやる。
・ルート(ルーティング)情報はルーティングテーブ　ルに保持

［ルーティングテーブル］
・以下のような情報を持つ
　　・宛先ネットワークアドレス
　　・宛先に対する、自分からの送信窓口
　　・宛先への、次のルータのアドレス
　　・宛先への最適ルートを選択する為の値

［ルーティングテーブルの学習］
・手動学習→スタティックルーティング方式
・自動学習→ダイナミックルーティング方式

［スタティックルーティング方式］
・ネットワーク管理者がルーティングテーブルに
　情報を登録する方式。
　主流ではないものの、特定のルートを任意に
　設定する際には必須。

［ダイナミックルーティング方式］
・ほかのルータからルーティング情報をもらう方式
・ルーティング情報をネットワークを通じて共有
　しあう方式。
・これを交換し合うプロトコルとして、
　・RIP(Routing Information Protocol)
　・OSPF(Open Shortest Path First)
　・BGP4(Border Gateway Protocol Ver4)
  ［特徴］
　　・RIP …単純で設定も容易
　　　　　　大規模ネットワークには不向き
　　・OSPF…大規模ネットワークにも対応可能
　　　　　　設定はやや複雑・難解

［デフォルトルート］
・一致するルーティング情報がない場合に送付する
　ルートになるもの。
　PCの設定におけるデフォルトゲートウェイと
　同様の考え方。

［異なるLAN間の接続］
・セグメントの異なるネットワーク(LAN)を接続
　するのもルータの役割です。
-----

［ルータの種類］適用範囲から見た分類
・エッジルータ/コアルータ
　通信事業者向け。最も高性能/高額/大型

・アクセスルータ(カスタマーエッジルータ)
　通信事業者を利用する顧客側がWANに接続する
　ルータ。価格はピンキリ。

・アクセスルータ(小規模向け)
　小規模拠点向け。数万円程度から10万円程度まで

・L3スイッチ
　拠点内ネットワーク

※その他
　マルチプロトコルルータ
　　TCP/IP以外のプロトコルも扱える

［L3スイッチと何が違う？］
　・L3スイッチ→ハードウェア処理
　・ルータ→→→ソフトウェア処理
　※とはいえ、現在ではハードウェア処理による
　　ルータも登場している。

［L3スイッチになく、ルータだけが持つ機能］
　・VPN, NAT/NAPT機能
　・PPPoE機能

［パケットフィルタリング］
　・特定の{アドレス/プロトコル}{への/からの}
    パケットを拒否させる仕組み

［冗長化で高信頼性］
　A・複数のルータ毎にWAN回線を保有
　B・１つのルータで複数のWAN回線を保有

　［A］の場合
　　用意するルータは同一機種・同一バージョン
　　用意する回線は、異なる通信事業者のもの

　高信頼性設計をするなら、[A]のパターンが
　基本です。

----------
【ネットワーク設計について】
［DMZ］非武装地帯
　・一般的には、外部に公開してよいサーバー類を
　　設置・接続するネットワークのゾーン
　・設置・構築にはファイアーウォールが必要

［ファイアーウォール］
　・社{内/外}及びDMZの境界となるところ。
　・{ハード/ソフト}ウェアタイプがある。
　・ハードウェアタイプを選ぶ方が無難
----- ----- ----- ----- ----- ----- -----
［以下の条件でネットワークを設計してください］
・ある会社があります。
・その会社は『道路を挟んで』本館と新館がある。
・『道路』は勝手に掘って工事できません。
・本館と新館は、ネットワークで接続します。
・本館と新館は、異なるネットワークにします。
・本館にファイルサーバーを置き、社内全体で利用
・本館からはインターネットVPNを利用します。
  →本館も外部ネットワークはインターネット回線へ接続
・新館からはバックアップ回線として、
  インターネット回線(光回線)に接続。
・公開用の{WEB/Mail/DNS}サーバーを設置します
・WEBサイトではDBと連携したコンテンツを提供
・本館には
　１階：総務部、経理部
　２階：営業部、製造部
　３階：人事部
・新館には
　１階：開発部
　２階：設計部、システム部
　があり、それぞれ２０台程度の端末が接続され、
　各部門ごとにネットワークを分けておくこと。
・ファイルサーバーは、前述の全社共用のものと、本館だけで利用可能なものと、
  新館だけで利用可能なものとをそれぞれ設置します。
・DMZは本館側に置くものとする
・WEBサーバーと連携するDBサーバーは、総務部のネットワーク内に設置
・各ユーザーの端末のIPアドレスはDHCPで設定されるものとする。
・ユーザーの端末以外の各機器のIPアドレスは、任意に決めてください。
・ルータ、ファイアウォール、L3スイッチなどの各ネットワーク機器の設定内容
・各種サーバの設定内容が分かるようにまとめておいてください
    WEBサーバ、およびMailサーバは『nt43k06.com』という名前で公開する


【課題】
課題No. 　　　06
課題主題　　　企業ネットワークの設計書①
提出納期　　　2020/10/27
科目記号　　　NT43
-------------
授業内回収, サーバー提出あり, 評価課題
